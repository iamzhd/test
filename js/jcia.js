
/*inc.js*/
function helpLoad() { hits(OBJ_ID, MARK); getHits(OBJ_ID, MARK); getHelpStatic(OBJ_ID); helpSelectCurrentPosition() } function helpSelectCurrentPosition() { var a = window.location.href.substring(window.location.href.lastIndexOf(".") + 1).toLowerCase(); if (a != "html") { $(".nr h4[sid='" + SID + "'],.nr li[sid='" + SID + "']").addClass("cur") } else { $(".nr h4[sid='" + SID + "'],.nr li[sid='" + SID + "']").addClass("cur"); if (!$(".nr%20.cur").size()) { $(".nr h4[sid='" + SID + "'],.nr li[sid='" + SID + "']").addClass("cur") } } } function newsLoad() { hits(OBJ_ID, MARK); getHits(OBJ_ID, MARK); writeComment(OBJ_ID, MARK); getLastArticle(); getHistory(MARK); addHistory(OBJ_ID, MARK); getNewProduct() } function newsSelectCurrentPosition() { $(".nr h4[sid='" + SID + "'],.nr li[sid='" + SID + "']").addClass("cur") } function productLoad() { productSelectCurrentPosition(SID); hits(ProductID, "product"); writeComment(ProductID, MARK); addHistory(ProductID, MARK); initImages(ProductID); getHistory("product"); getRecommentProductByHistory(ProductID); getRelevantViewed(ProductID); for (var a = 0; a < ARR_AD_MARK.length; ++a) { getAd(ARR_AD_MARK[a], "cntrAd_" + a) } checkSize() } function downLoad() { hits(DownloadID, "download"); writeComment(DownloadID, MARK); addHistory(DownloadID, MARK); getHistory("download"); getRelevantViewedDownload(DownloadID) } function projectLoad() { productSelectCurrentPosition(SID); hits(ProjectID, "project"); writeComment(ProjectID, MARK); addHistory(ProjectID, MARK); getVideo(VIDEO_KEY); getHistory("project"); getRecommentProjectByHistory(ProjectID); getRelevantViewedProject(ProjectID); for (var a = 0; a < ARR_AD_MARK.length; ++a) { getAd(ARR_AD_MARK[a], "cntrAd_" + a) } checkSize() } function getTaoCanPrice(a) { $.post("ajax.ashx@action=gettaocanprice&t=" + Math.random(), { IDList: a }, function (d) { var c = gav(d, "OldPrice"); var b = gav(d, "NowPrice"); $j("OldPrice").html(c); $j("NowPrice").html(b) }) } function ShowTaoCanProduct() { $(document).ready(function () { $(".cbox").find("input").click(function () { var a = new Array(); a = $("#txtIDList").attr("value").split(","); var b = a[0]; if (!this.checked) { $(".tao_rt").find("a[id=" + this.value + "]").hide(); $(".tao_rt").find("a[id=" + this.value + "]").prev().hide(); for (var c = 0; c < a.length; c++) { if (this.value != a[c] && a[c] != a[0] && this.value != a[c]) { b = b + "," + a[c] } } } else { $(".tao_rt").find("a[id=" + this.value + "]").show(); $(".tao_rt").find("a[id=" + this.value + "]").prev().show(); b = $("#txtIDList").attr("value") + "," + this.value } $("#txtIDList").val(b); $("#TCount").html($("#txtIDList").attr("value").split(",").length); getTaoCanPrice(b) }) }) } function initCommonHeader() { $.get("ajax.ashx@action=initcommonheader&t=" + Math.random(), function (a) { var d = gav(a, "username"); var c = gav(a, "usermenu"); var b = gav(a, "myphoto"); if (d.length > 0) { $("#guest").hide(); $("#user").show(); $j("commonHeaderGuest").hide(); $j("commonHeaderUsername").html(d); $j("commonHeaderUsermenu").html(c); $j("commonHeaderUserPhoto").attr("src", b); $j("commonHeaderUser").fadeIn(80) } }) } function checkSize() { $(document).ready(function () { $(".pro_kuang").find("li").click(function () { $(this).parent().find("a").removeClass(); $(this).find("a").addClass("img") }) }) } function checkWishSize(g) { $(g).parent().find("a").removeClass(); $(g).addClass("clicked"); if ($("#txtAttr").html() == "") { $("#txtAttr").append($(g).attr("title")) } else { var a = new Array(); a = $("#txtAttr").html().split(","); for (var e = 0; e < a.length; e++) { var b = a[e].split(":")[0]; var d = $(g).attr("title").split(":")[0]; var c = $(g).attr("title").split(":")[1]; var f = b + ":" + c; if (b == d) { $("#txtAttr").html($("#txtAttr").html().replace(a[e], f)); return } } $("#txtAttr").append("," + $(g).attr("title")) } } function getAttrValesPhotos(a) { $.post("/ajax.ashx?action=attrValuesPhotos&t=" + Math.random(), { oid: a }, function (b) { $j("img_list").html(b) }) } function switchProdTab(d) { var b = $(d); var a = b.attr("target_id"); var c = b.parent().find("a[class=cr]"); if (c.attr("target_id") == a) { return } c.removeClass("cr"); b.addClass("cr"); $j("cntrRelevantProd>div").hide(); $j(a).show() } function agentLoad() { hits(OBJ_ID, MARK); getHits(OBJ_ID, MARK); getAgentHelpStatic(OBJ_ID); getAd(MARK, "cntrAd") } function keepUsername(a, b) { var c = $j(b).attr("value"); if (a != null && c != undefined) { if (a) { $cookie("__oran__k_username", c, 99999999999) } else { $cookie("__oran__k_username", false) } return } if (!$j("chkKeep").attr("checked")) { return } if (c != undefined) { $cookie("__oran__k_username", c, 99999999999) } } function toggleJobDetail(d, c) { var a = $(d).parent().next(); var b = $(d).parent(); if (a.is(":visible")) { a.slideUp(80); b.css({ background: "url(" + c + "img/ico14.gif) no-repeat 0 5px" }) } else { a.slideDown(80); b.css({ background: "url(" + c + "img/ico13.gif) no-repeat 0 5px" }) } } function showAllColumns(a) { if (a == null) { a = true } if (a) { showFullBg() } setCM("prod_all_columns"); relocation("prod_all_columns") } function hideAllColumns(a) { if (a == null) { a = true } if (a) { hideFullBg() } $j("prod_all_columns").fadeOut(80) } function showBgProc(a, d) { if (d == null) { d = "正在处理..." } var b = "oran_div_processing"; var c = $j(b); if (c.length == 0) { $(document.body).append("<div id='" + b + "'><p><img src='" + SKIN_PATH + "img/processing_2.gif' id='imgProc' alt='" + d + "' /></p><p class='mt10'>" + d + "</p></div>") } c = $j(b); if (a == null) { a = true } if (a) { showFullBg("oran_full_bg_2"); setCM(b); relocation(b); c.fadeIn(80) } else { c.fadeOut(80); hideFullBg("oran_full_bg_2") } } function gav(d, a) { var c = $(d); var b = $(c.find("node[key=" + a + "]")).text(); return b } function sc(b, a) { b.attr("class", a) } function ddlSecQus_Changed(c, a) { if (a == null) { a = "txtSecQus" } var b = $j(a); if (c.value == "") { b.show(); b.attr("value", "").focus() } else { b.hide() } b.attr("value", c.value) } function showMyAddress(b) { if (b == null) { b = true } if (b) { showFullBg("oran_full_bg", false) } var a = $("#divCartMyAddr > iframe"); a.attr("src", "layer/MyAddress.aspx"); setCM("divCartMyAddr") } function hideMyAddress() { top.window.hideFullBg("oran_full_bg"); $(top.window.document).find("#divCartMyAddr").fadeOut(80) } function setMyAddr(a) { var k = $(a).parent().parent().parent(); var h = k.find("span[name=chnName]").html(); var e = k.find("span[name=province]").html(); var f = k.find("span[name=city]").html(); var j = k.find("span[name=address]").html(); var b = k.find("span[name=zipCode]").html(); var g = k.find("span[name=tel]").html(); var c = k.find("span[name=mobile]").html(); var i = k.find("span[name=email]").html(); var d = $(top.window.document); d.find("#txtAddrName").val(h); d.find("#txtInvoiceTitle").val(h); d.find("#txtEmail").val(i); d.find("#txtAddrAddr").val(j); d.find("#txtAddrZip").val(b); d.find("#txtAddrTel").val(g); d.find("#txtAddrMobile").val(c); $(top.window.document).find("#regionAddr_hdnPrtRegion").val(e); $(top.window.document).find("#regionAddr_hdnChdRegion").val(f); top.window.regionAddr_initSelectedItems(); hideMyAddress() } function checkPinForm() { var c = $j("txtNewPin").val(); var b = $j("txtSecAsr").val(); var a = $j("txtNewEmail").val(); if (c.length == 0 && b == 0 && a.length == 0) { $a("未有任何修改项", 2); return false } else { return true } } function switchOrderTab(b) { var a = $j("ulOrderTypeTabs"); a.find("a").removeClass("cur b cblack f14"); $(b).addClass("cur b cblack f14").blur() } function searchOrder() { var g = $tv("txOrderNo"); var a = $tv("txtStartDate"); var f = $tv("txtEndDate"); var e = $tv("ddlOrderStates"); var c = $("#ulOrderTypeTabs").find(".cur").attr("ordertype"); if (g.length == 0 && a.length == 0 && f.length == 0 && e.length == 0) { $a("至少需要一个查询条件。"); return } var b = false; var d = "orderlist.aspx?"; if (g.length > 0) { d += "no=" + g; b = true } if (a.length > 0) { if (b) { d += "&" } d += "start=" + a; b = true } if (f.length > 0) { if (b) { d += "&" } d += "end=" + f; b = true } if (e.length > 0) { if (b) { d += "&" } d += "state=" + e; b = true } if (c != undefined && c.length > 0) { if (b) { d += "&" } d += "type=" + c; b = true } location.href = d } function searchFav() { var c = $tv("txtFavKwd"); var d = $tv("ddlFavClns"); var a = false; var b = "MyFavorites.aspx?"; if (c.length > 0) { b += "kwd=" + encodeURI(c); a = true } if (d.length > 0) { if (a) { b += "&" } b += "oid=" + d; a = true } location.href = b } function customizePriceRange(f) { var c = $(f).parent().find("input:eq(0)"); var e = $(f).parent().find("input:eq(1)"); var b = parseInt(c.val()); var d = parseInt(e.val()); var a = "/product/list.aspx?"; if (!b) { b = 0 } if (!d) { d = 0 } if (b == 0 && d == 0) { $a("至少需要一个价格范围。"); c.focus(); return } if (b > 0 && d > 0) { a += "PriceLower=" + b + "&PriceUpper=" + d } else { if (b > 0) { a += "PriceUpper=" + b } else { if (d > 0) { a += "PriceLower=" + d } } } location.href = a } function copyUrl(c) { var b = $j("div_nsw_copy_url"); var a = location.href; if (b.length == 0) { var d = "<div id='div_nsw_copy_url'><h1><a href='javascript:void(0)' onclick=\"$(this).parent().parent().fadeOut(80);hideFullBg('div_nsw_copy_url_bg')\"><img src='" + SKIN_PATH + "img/ico9_close.gif' /></a>拷贝链接地址</h1><div class='cont'><div>拷贝本URL从您的博客或者网站链接到本" + (c == "product" ? "产品" : "文章") + "</div><textarea>" + a + "</textarea><div><input type='button' value='拷贝地址' onclick='copyArticleUrl()' class='b13' /></div></div></div>"; $(document.body).append(d) } setCM("div_nsw_copy_url"); relocation("div_nsw_copy_url"); showFullBg("div_nsw_copy_url_bg") } function copyArticleUrl() { var a = $("#div_nsw_copy_url .cont textarea").val(); window.clipboardData.setData("Text", a); $a("本网页地址已复制到粘帖板。", 1) } function initImages(c) { var a = '<li {$co$}><a href="{$path$}" target="_blank" title="{$title$}"><img title="{$title$}" alt="{$title$}" longdesc="{$path$}" src="{$path$}"  width="60" height="60"></a></li>'; var d = ""; for (var b = 0; b < ARR_IMG_PATH.length; ++b) { if (b == 0) { d = a.replace(/\{\$co\$\}/ig, "class='now'").replace(/\{\$path\$\}/ig, ARR_IMG_PATH[b]).replace(/\{\$title\$\}/ig, OBJ_TITLE) } else { d += a.replace(/\{\$co\$\}/ig, "").replace(/\{\$path\$\}/ig, ARR_IMG_PATH[b]).replace(/\{\$title\$\}/ig, OBJ_TITLE) } } $("#img_list").html(d) } function setSelectedImg(a) { $(a).parent().find("a").removeClass("cur"); $(a).addClass("cur") } function viewBigImage(b) { var c = window.location.host; var a = "product/gallery.aspx@oid=" + b; if (c != "undefined") { a += "&selectedpath=http://" + c } window.open(a) } function switchImage(d) { var a = $(".MagicZoom"); var b = a.find("img:eq(0)"); var c = $(".MagicZoomBigImageCont img"); var e = $(d).find("img").attr("srcimg"); a.attr("href", e); b.attr("src", e); c.attr("src", e); $j("btnShowOrgiImg").click(function () { window.open(e, "orgiImg") }) } function initViewPhoto() { $j("imgBig").attr("src", $("#ulPhotos>li>a>img").attr("src")); $("#ulPhotos>li>a:eq(0)").addClass("cur"); resetNextPrevious($("#ulPhotos>li>a:eq(0)").get()) } function viewPhoto(a) { $j("imgBig").attr("src", $(a).find("img").attr("src")); $("#ulPhotos>li>a").removeClass("cur"); $(a).addClass("cur").blur(); resetNextPrevious(a) } function resetNextPrevious(b) { var c = $(b).parent().prev(); if (c.length == 0) { c = $("#ulPhotos>li:last") } var a = $(b).parent().next(); if (a.length == 0) { a = $("#ulPhotos>li:first") } $j("btnPrev").removeAttr("onclick").click(function () { viewPhoto(c.find("a").get()) }); $j("btnNext").removeAttr("onclick").click(function () { viewPhoto(a.find("a").get()) }) } function mailArticle(d, b) { var a = $j("mailArticle"); if (a.length == 0) { var c = "<div id='mailArticle'><iframe src='private/sendnewstoyourfriends.aspx@oid=" + b + "' frameborder='0'></iframe></div>"; $(document.body).append(c) } setCM("mailArticle"); showFullBg("mailArticle_bg", null, null, null, null, null, function () { $("#mailArticle iframe").css("visibility", "visible") }); relocation("mailArticle") } function mailProduct(b, a) { $j("mailArticle").html("<iframe src='private/sendproducttoyourfriends.aspx@oid=" + a + "' frameborder='0'></iframe>"); setCM("mailArticle"); showFullBg("mailArticle_bg", null, null, null, null, null, function () { $("#mailArticle iframe").css("visibility", "visible") }); relocation("mailArticle") } function mailDownload(b, a) { $j("mailArticle").html("<iframe src='private/senddownloadtoyourfriends.aspx@oid=" + a + "' frameborder='0'></iframe>"); setCM("mailArticle"); showFullBg("mailArticle_bg", null, null, null, null, null, function () { $("#mailArticle iframe").css("visibility", "visible") }); relocation("mailArticle") } function hideMailAtricle() { $(top.document.getElementById("mailArticle")).fadeOut(80); $(top.document.getElementById("mailArticle_bg")).fadeOut(80); top.showDdl() } function contractExtend(f, c) { var b = $(f); var d = b.parent().next(); var e; var a; if (b.attr("alt") == "收缩") { e = "展开"; a = "img/ico15_.gif"; d.slideUp(80) } else { e = "收缩"; a = "img/ico15.gif"; d.slideDown(80) } b.attr({ src: c + a, alt: e }) } function showLayer(a, c, b) { setCM(a); relocation(a); showFullBg(c, null, null, null, null, null, b) } function hideLayer(a, b) { $j(a).fadeOut(80); hideFullBg(b) } function hideAdvanNewsSearch() { $(top.document).find("#div_nsw_news_advan_cntr").fadeOut(80); $(top.document).find("#div_nsw_news_advan_bg").fadeOut(80); top.showDdl() } function advanNewsSearch() { var a = "/search/news.aspx?type="; a += $g("rdoFuzzy").checked ? "1" : "2"; top.location.href = SearchObjectByGet("ddlFields,tg|ddlNewsColumns2,sid|txtKwd,kwd|txtStartDate,start|txtEndDate,end", a, true) } function contractExtendProdColumn(f, c) { var b = $(f); var d = b.parent().parent().next(); var e; var a; if (b.attr("alt") == "收缩") { e = "展开"; a = "img/ico14.gif"; d.slideUp(80) } else { e = "收缩"; a = "img/ico13.gif"; d.slideDown(80) } b.attr({ src: c + a, alt: e }) } function resetOrderList(a) { var c = a.lastIndexOf("/"); a = a.substring(c + 1); var b = $j("ddlOrderBy").find("option"); b.each(function (d) { if ($(b[d]).attr("value") == a) { $(b[d]).attr("selected", "selected") } }) } function initNextPre() { var c = $j("pagerMain").find("a[class=oran_pg_pp]"); if (c.length == 0) { $j("btnPrePage").click(function () { $a("这已是第一页。") }) } else { var d = c.attr("href"); $j("btnPrePage").click(function () { location.href = d }) } var a = $j("pagerMain").find("a[class=oran_pg_np]"); if (a.length == 0) { $j("btnNextPage").click(function () { $a("这已是最后一页。") }) } else { var b = a.attr("href"); $j("btnNextPage").click(function () { location.href = b }) } } function increaseScroll(a) { var b = 1; var c = setInterval(function () { if (b > 320) { window.clearInterval(c) } $g("img_list").scrollLeft += 14; b += 14 }, 1) } function decreaseScroll(a) { var b = 1; var c = setInterval(function () { if (b > 320) { window.clearInterval(c) } $g("img_list").scrollLeft -= 14; b += 14 }, 1) } function payadScroll(e, a, c) { var d = $j("payad_" + a); var b = $j("payad_" + e); if (d.length == 0) { d = $j("payad_" + c) } b.fadeOut("80", function () { d.show() }) } function showReport(c) { var a = $j("RPT_cntr"); if (a.length == 0) { var b = '<div class="reports" id="RPT_cntr"><h1><a href="javascript:void(0)" onclick="$closeLayer(\'RPT_cntr\',\'RPT____BG\')" class="close2"><img src="' + SKIN_PATH + 'img/close2.gif" alt="关闭" title="关闭" /></a>报告/纠错/举报</h1><table id="RPT_tab"><tr><th>被报告网站标题：</th><td><input type="text" size="40" disabled="disabled" value="' + document.title + '" /></td></tr><tr><th>被报告网址：</th><td><input type="text" size="40" disabled="disabled" value="' + document.URL + '" /></td></tr><tr><th>* 报告类型：</th><td id="RPT_tdCats"></td></tr><tr><th>联系人：</th><td><input type="text" size="10" id="RPT_txtContact" /></td></tr><tr><th>电子邮箱地址：</th><td><input type="text" size="30" id="RPT_txtEmail" /></td></tr><tr><th>报告内容简要描述：</th><td><textarea style="width:230px;height:80px;" id="RPT_txtShortDesc"></textarea></td></tr><tr><th>&nbsp;</th><td><input type="button"  value="关闭" class="b18 fr" onclick="$(\'#RPT_cntr>h1>a\').click()" /> <input type="button"  value="提交" class="b15" onclick="sendReprots(this)" /> </td></tr></table></div>'; $(document.body).append(b); fillReportCategories() } a.show(); showFullBg("RPT____BG", null, null, null, null, null, function () { $j("RPT_cats").css("visibility", "visible") }); setCM("RPT_cntr"); relocation("RPT_cntr") } function showLeaveword(c) { var a = $j("LEAVEWORD_cntr"); if (a.length == 0) { var b = '<div class="reports" id="LEAVEWORD_cntr"><h1><a href="javascript:void(0)" onclick="$closeLayer(\'LEAVEWORD_cntr\',\'LEAVEWORD____BG\')" class="close2"><img src="' + SKIN_PATH + 'img/close2.gif" alt="关闭" title="关闭" /></a>留言</h1><table id="LEAVEWORD_tab"><tr><th>* 标题：</th><td><input type="text" size="40" id="LEAVEWORD_txtTitle" /></td></tr><tr><th>* 联系人：</th><td><input type="text" size="10" id="LEAVEWORD_txtContact" /></td></tr><tr><th>联系电话：</th><td><input type="text" size="30" id="LEAVEWORD_txtTel" /></td></tr><tr><th>手机号码：</th><td><input type="text" size="30" id="LEAVEWORD_txtMobile" /></td></tr><tr><th>* 电子邮箱地址：</th><td><input type="text" size="30" id="LEAVEWORD_txtEmail" /></td></tr><tr><th>* 留言分类：</th><td id="LEAVEWORD_tdCats"></td></tr><tr><th>留言内容：</th><td><textarea style="width:230px;height:80px;" id="LEAVEWORD_txtShortDesc"></textarea></td></tr><tr><th>&nbsp;</th><td><input type="button"  value="关闭" class="b18 fr" onclick="$(\'#LEAVEWORD_cntr>h1>a\').click()" /> <input type="button"  value="提交" class="b15" onclick="sendLeaveword(this)" /> </td></tr></table></div>'; $(document.body).append(b); fillLeavewordCategories() } a.show(); showFullBg("LEAVEWORD____BG", null, null, null, null, null, function () { $j("LEAVEWORD_cats").css("visibility", "visible") }); setCM("LEAVEWORD_cntr"); relocation("LEAVEWORD_cntr") } function showDirectPay(c) { var a = $j("DIR_PAY_cntr"); if (a.length == 0) { var b = '<div class="reports" id="DIR_PAY_cntr"><h1><a href="javascript:void(0)" onclick="$closeLayer(\'DIR_PAY_cntr\',\'DIR_PAY____BG\')" class="close2"><img src="' + SKIN_PATH + 'img/close2.gif" alt="关闭" title="关闭" /></a>付款</h1><table id="DIR_PAY_tab" style="background:url(' + SKIN_PATH + 'img/Pay_ico.gif) no-repeat right top;width:400px;"><tr><tr><th>* 付款方式：</th><td><select id="DIR_PAY_ddlPayment"><option value="">请选择</option><option value="alipay">支付宝</option><option value="99bill">快钱</option></select></td></tr><th>* 付款人：</th><td><input type="text" size="20" id="DIR_PAY_txtPayer" /></td></tr><tr><th>* 电子邮箱地址：</th><td><input type="text" size="20" id="DIR_PAY_txtEmail" /></td></tr><tr><th>联系电话：</th><td><input type="text" size="20" id="DIR_PAY_txtTel" /></td></tr><tr><th>手机号码：</th><td><input type="text" size="20" id="DIR_PAY_txtMobile" /></td></tr><tr><th>我公司业务员姓名：</th><td><input type="text" size="20" id="DIR_PAY_txtSalesManName" /></td></tr><tr><th>* 付款金额：</th><td><input type="text" size="10" id="DIR_PAY_txtMoney" /></td></tr><tr><th>* 款项用途：</th><td><input type="text" size="40" id="DIR_PAY_txtUse" /></td></tr><tr><th>&nbsp;</th><td><input type="button"  value="关闭" class="b18 fr" onclick="$(\'#DIR_PAY_cntr>h1>a\').click()" /> <input type="button"  value="提交" class="b15" onclick="directPay(this)" /> </td></tr></table></div>'; $(document.body).append(b) } a.show(); showFullBg("DIR_PAY____BG", null, null, null, null, null, function () { $j("DIR_PAY_ddlPayment").css("visibility", "visible") }); setCM("DIR_PAY_cntr"); relocation("DIR_PAY_cntr") } function showFav(g, f, c) { if (c == null) { c = location.pathname } var b = "div_fav_cntr"; var h = "private/favorite.aspx@url=" + c + "&title=" + f; h = h.toLowerCase(); var a = $j(b); if (a.length != 0) { a.remove() } var e = '<div style="z-index:99;position:absolute;" id="' + b + '"><iframe src="' + h + "\" frameborder='0'></iframe></div>"; $(document.body).append(e); a = $j(b); var d = getObjectOffset(g); a.css({ top: d.bottom - 130, left: d.right - 200 }) } function closeTopLayer(a) { var b = $(top.document).find("#" + a); b.fadeOut(); top.hideFullBg() } function getObjectOffset(d) { var a = $(d); var c = a.offset(); var b = { top: c.top, left: c.left, bottom: c.top + a.height(), right: c.left + a.width() }; return b } function productSelectCurrentPosition(a) { $(".nr h4[sid='" + a + "'],.nr h5[sid='" + a + "'],.nr li[sid='" + a + "']").addClass("cur") } function ShowHelp(b) { var a = $j("div_nsw_show_help"); if (a.length == 0) { var c = "<div id='div_nsw_show_help'><h1><a href='javascript:void(0)' onclick=\"$(this).parent().parent().fadeOut(80);hideFullBg('div_nsw_show_help_bg')\"><img src='" + SKIN_PATH + "img/ico9_close.gif' /></a>帮助说明</h1><div class='cont'><textarea>" + b + "</textarea></div></div>"; $(document.body).append(c) } setCM("div_nsw_show_help"); relocation("div_nsw_show_help"); showFullBg("div_nsw_show_help_bg") } function onclPrReAtts(b, f, a) { var g = false; $("#" + b).html(f); if (atts == null || atts == "") { atts = a + "," + f } else { var d = new Array(); d = atts.split("$"); if (d.length <= 0) { atts = atts + "$" + a + "," + f } else { atts = ""; for (var e = 0; e < d.length; e++) { var h = ""; var c = d[e].split(","); if (c.length == 2) { h = c[1]; if (c[0] == a) { h = f; g = true } if (atts == null || atts == "") { atts = c[0] + "," + h } else { atts = atts + "$" + c[0] + "," + h } } } if (g == false) { if (atts == null || atts == "") { atts = a + "," + f } else { atts = atts + "$" + a + "," + f } } } } } function switchAttrTab(c) { var a = $(c); if (a.attr("class") == "cur") { return } var b = a.attr("item_name"); $j("div__detail").hide(); $j("div__attr").hide(); $j("div__" + b).show(); $(".prod_tab").find("a").removeClass("cur"); a.addClass("cur") } function switchExtendAttrTab(f, g) { var d = f; var a = f.substring(f.length - 1, f.length); for (var b = 0; b < g; b++) { var c = "detailvalue" + b; var e = "detail" + b; if (a == b) { $j(c).show(); $j(e).addClass("cur") } else { $j(c).hide(); $j(e).removeClass() } } } function switchExtendContentTab(g, h, a) { var e = g; var b = g.substring(g.length - 1, g.length); for (var c = 0; c < h; c++) { var d = "contentvalue" + a + c; var f = "content" + a + c; if (b == c) { $j(d).show(); $j(f).addClass("cur") } else { $j(d).hide(); $j(f).removeClass() } } } $(function () { var e = 7; var v = 4; var a = 0; var u = 9; var b = 6; var d = 0; var m = 0; var p = ""; var w = $("div.plc"); var g = $("div.plc2"); var r = $("div.pro_curmbs"); var f = w.size() ? w : g; var l = f.size() ? f : r; var h = $("div.menu"); var n = h.children("ul").children("li"); var c = l.find("a"); var k = c.size(); var j = "cur"; h.find("li").removeClass(j); var t = new Object(); t.getCurrentURL = function () { switch (MARK) { case "product": p = v ? v : MARK; break; case "news": p = e ? e : MARK; break; case "project": p = b ? b : MARK; break; case "agent": p = a ? a : MARK; break; case "help": p = u ? u : MARK; break; case "download": p = d ? d : MARK; break; case "job": p = m ? m : MARK; break; default: p = 0; break } return p }; t.firstLiCur = function () { h.find("li:first").addClass(j) }; t.selectedCur = function () { n.children("a").each(function () { var i = $(this).attr("href").toLowerCase(); i = i.substring(i.lastIndexOf("/") + 1); if (i == p) { $(this).parent("li").addClass(j); return false } else { if (typeof (p) == "number") { n.eq(p).addClass(j); return false } } }) }; t.selectedTxtCur = function () { n.children("a").each(function () { var i = $.trim($(this).text()); if (i == o && o.indexOf("首页") == -1) { $(this).parent("li").addClass(j); return false } }); return h.children("ul").children("li." + j) }; t.hasCur = function () { var i = h.children("ul").children("li." + j).size(); return i }; if (typeof (MARK) == "undefined") { t.firstLiCur(); return false } if (!k) { p = t.getCurrentURL(); t.selectedCur(); return false } for (var q = k - 1; q >= 0; q--) { p = c.eq(q).attr("href"); var o = $.trim(c.eq(q).text()); p = p.substring(p.lastIndexOf("/") + 1).toLowerCase(); if (p == "" || p == undefined) { p = t.getCurrentURL() } var s = t.selectedTxtCur(); if (s.size() && o.indexOf("首页") == -1) { s.parent("li").addClass(j); return false } else { t.selectedCur(); if (t.hasCur()) { return false } } } if (!t.hasCur()) { p = MARK; t.selectedCur(); if (!t.hasCur()) { t.firstLiCur() } } else { } }); function removeProductInfoTags() { if (!$.trim($("div.pd_attr").text())) { $("div.pd_attr").remove() } if (!$.trim($("div.pd_short").text())) { $("div.pd_short").remove() } } function SetHome(c, d) { try { c.style.behavior = "url(#default#homepage)"; c.setHomePage(d) } catch (b) { if (window.netscape) { try { netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect") } catch (b) { alert("抱歉！您的浏览器不支持直接设为首页。请在浏览器地址栏输入“about:config”并回车然后将[signed.applets.codebase_principal_support]设置为“true”，点击“加入收藏”后忽略安全提示，即可设置成功。") } var a = Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefBranch); a.setCharPref("browser.startup.homepage", d) } else { alert("抱歉，您的浏览器不支持自动设置首页, 请使用浏览器菜单手动设置!") } } };
/*ajax.js*/
var flag = false; function DrawImage(e, b, a, d) { var c = new Image(); c.src = e.src; if (c.width > 0 && c.height > 0) { flag = true; if (c.width / c.height >= b / a) { if (c.width > b) { e.width = b; e.height = (c.height * b) / c.width } else { e.width = c.width; e.height = c.height } if (d == 1) { if (a > e.height && b > e.width) { e.style.padding = (a - e.height) / 2 + "px 0 0 " + (b - c.width) / 2 + "px" } else { if (a > e.height) { e.style.padding = (a - e.height) / 2 + "px 0 0 0" } else { if (b > e.width) { e.style.padding = "0 0 0 " + (b - e.width) / 2 + "px" } } } } } else { if (c.height > a) { e.height = a; e.width = (c.width * a) / c.height } else { e.width = c.width; e.height = c.height } if (d == 1) { if (a > e.height && b > e.width) { e.style.padding = (a - e.height) / 2 + "px 0 0 " + (b - e.width) / 2 + "px" } else { if (a > e.height) { e.style.padding = (a - e.height) / 2 + "px 0 0 0" } else { if (b > e.width) { e.style.padding = "0 0 0 " + (b - e.width) / 2 + "px" } } } } } } } function showIM(a) { if ($("#bodd").html() != "") { if (a == "True") { $("#bodd").show(); $("#kefubtn").hide(); $("#divOranIm").show() } else { $("#bodd").hide(); $("#kefubtn").show(); $("#divOranIm").hide() } } } function initCommonHeaderKeywords(a) { if (a == "") { a = "6" } $.post("ajax.ashx@action=initcommonheaderkeywords&t=" + Math.random(), { s: a }, function (b) { $j("commonHeaderkeywords").html(b) }) } function addToCart(f, c, a, e, b, h, d) { showProc(f); if (h == null) { h = false } e = $j(e).html(); b = $j(b).val(); var g; if (a == null) { g = 1 } else { if (typeof (a) == "number") { g = a } else { g = $tv(a) } } if (e == null) { e = "" } if (b == null) { b = "" } $.post("ajax.ashx@action=addtocart&t=" + Math.random(), { pid: c, quti: g, atts: e, pidlist: b }, function (m) { var j = gav(m, "msg"); var l = gav(m, "count"); var k = gav(m, "state"); if (d != null) { location.href = d; return } if (k != "1") { $a(j); showProc(f, false); return } $confirm(j, { title: "去结算", toDo: "paycenter/cart.aspx" }, { title: "再选购", toDo: function () { hideConfirm() } }); $j("headerCartCount").html(l); if (h && (gav(m, "state") == 1) && confirm("添加到购物车成功，是否马上刷新页面购物车页面？\r\n\r\n是 - 刷新本页面查看最新结果\r\n否 - 保留当前页面状态")) { location.href = "cart.aspx@t=" + Math.random(); return } showProc(f, false) }) } function emptyCart(a) { showBgProc(); $.get("ajax.ashx@action=emptycart&t=" + Math.random(), function (b) { if (b == "1") { $a("清空购物车成功，单击确认返回产品中心。", 1, false, null, "消息", function () { location.href = "product" }) } else { $a("清空购物车失败，请稍候重试。") } showBgProc(false) }) } function changeQuantity(d, b, c) { var a = $(d).parent().find("input").attr("value"); if (!/^\d+$/.test(a)) { $a("数量必须是一个整数。"); return } if (parseInt(a) == 0) { $a("数量必须大于0，若要删商品，请点操作中的‘删除’。"); return } showBgProc(); $.post("ajax.ashx@action=addtocart&t=" + Math.random(), { pid: b, quti: a, atts: c }, function (e) { if (gav(e, "state") == "1") { if (confirm("数量修改成功，是否马上刷新页面查看购物车结果？\n\n是 - 刷新页面查看结果\n否 - 保留当前页面状态")) { location.href = "cart.aspx@t=" + Math.random() } else { showBgProc(false); $(d).hide() } } else { $a(e); showBgProc(false) } }) } function delCartProduct(c, a, b) { showBgProc(); var d = 0; $.post("ajax.ashx@action=addtocart&t=" + Math.random(), { pid: a, atts: b }, function (e) { if (gav(e, "state") == "1") { if (confirm("商品已删除，是否马上刷新页面查看结果？\n\n\r\n是 - 刷新页面查看结果\n否 - 保留当前页面状态")) { location.href = "cart.aspx@t=" + Math.random() } } else { $a(gav(e, "msg")) } showBgProc(false) }) } function changeQuantity(c, b) { var a = $(c).parent().find("input").attr("value"); if (!/^\d+$/.test(a)) { $a("数量必须是一个整数。"); return } if (parseInt(a) == 0) { $a("数量必须大于0，若要删商品，请点操作中的‘删除’。"); return } showBgProc(); $.post("ajax.ashx@action=addtocart&t=" + Math.random(), { pid: b, quti: a }, function (d) { if (gav(d, "state") == "1") { if (confirm("数量修改成功，是否马上刷新页面查看购物车结果？\n\n是 - 刷新页面查看结果\n否 - 保留当前页面状态")) { location.href = "cart.aspx@t=" + Math.random() } else { showBgProc(false); $(c).hide() } } else { $a(d); showBgProc(false) } }) } function delCartProduct(c, a, b) { showBgProc(); var d = 0; $.post("ajax.ashx@action=addtocart&t=" + Math.random(), { pid: a, atts: b }, function (e) { if (gav(e, "state") == "1") { if (confirm("商品已删除，是否马上刷新页面查看结果？\n\n\r\n是 - 刷新页面查看结果\n否 - 保留当前页面状态")) { location.href = "cart.aspx@t=" + Math.random() } } else { $a(gav(e, "msg")) } showBgProc(false) }) } function cancelOrder(b, a) { showBgProc(); $.post("ajax.ashx@action=cancelorder&t=" + Math.random(), { no: a }, function (c) { if (gav(c, "state") == "1") { $(b).parent().parent().parent().find("td[name=orderstate]").html("已取消"); $(b).hide() } else { $a("<p>取消订单操作失败。</p><p>非‘待审核’状态、已锁定等订单不可取消。</p>") } showBgProc(false) }) } function delFavColumn(b, a) { showBgProc(); $.post("/ajax.ashx?action=delfavfolumn&t=" + Math.random(), { oid: a }, function (c) { if (gav(c, "state") == "1") { $(b).parent().parent().fadeOut(80).remove() } else { $a("操作失败，请稍候重试。") } showBgProc(false) }) } function delMyWish(c, a) { var b = getCheckedVal(a); if (b.length == 0) { $a("无选中项。"); return } showBgProc(); $.post("/ajax.ashx?action=delMyWishs&t=" + Math.random(), { ids: b }, function (e) { if (gav(e, "state") == "1") { var d = $j(a).find("input[name=item]:checked"); d.each(function (f) { $(this).parent().parent().remove() }) } else { $a(gav(e, "msg")) } showBgProc(false) }) } function delMyDownloads(c, a) { var b = getCheckedVal(a); if (b.length == 0) { $a("无选中项。"); return } showBgProc(); $.post("ajax.ashx@action=delmydownloads&t=" + Math.random(), { ids: b }, function (e) { if (gav(e, "state") == "1") { var d = $j(a).find("input[name=item]:checked"); d.each(function (f) { $(this).parent().parent().remove() }) } else { $a(gav(e, "msg")) } showBgProc(false) }) } function addFav(d, c, b, a) { if (b == null) { b = location.pathname } if (c == null) { c = document.title } $.post("ajax.ashx@action=fav&t=" + Math.random(), { url: b, ptitle: c, column_id: a }, function (g) { var f = gav(g, "state"); var e = gav(g, "msg"); if (f == "1") { closeTopLayer("div_fav_cntr") } else { top.$a(e, "2"); closeTopLayer("div_fav_cntr") } }) } function delFav(c, a) { var b = getCheckedVal(a); if (b.length == 0) { $a("无选中项。"); return } showBgProc(); $.post("ajax.ashx@action=delfav&t=" + Math.random(), { ids: b }, function (e) { if (gav(e, "state") == "1") { var d = $j(a).find("input[name=item]:checked"); d.each(function (f) { $(this).parent().parent().remove() }) } else { $a(gav(e, "msg")) } showBgProc(false) }) } function hits(a, b) { $.post("ajax.ashx@action=hits&t=" + Math.random(), { oid: a, mark: b }) } function postComment(e, c, d) { showProc(e); var a = $tv("txtCmtContent"); var b = $tv("txtCmtVerCode"); if (a == "") { $a("内容必填。"); showProc(e, false); return } if ($g("txtVerCode") != null && s_verCode == "") { $a("验证码不可空。"); showProc(e, false); return } $.post("ajax.ashx@action=postcomment&t=" + Math.random(), { content: a, oid: c, verCode: b, mark: d }, function (h) { var k = gav(h, "state"); var j = gav(h, "msg"); if (k == "") { $a(h, -1) } else { if (k == "2") { $a(j, 1); emptyText("tbCmt") } else { if (k == "1") { var o = gav(h, "time"); var g = gav(h, "username"); var p = gav(h, "ip"); var m = gav(h, "comment"); var f = gav(h, "feedback"); var l = gav(h, "num"); var n = "<dl><dd>{$username$}<span class='ip'>IP：{$ip$}</span>时间：{$time$}</dd><dd class='c666 con mt8 mb10'>{$content$}</dd><dd class='huifu'><h5>管理员回复：</h5><div>{$feedback$}</div></dd></dl>"; var q = n.replace("{$username$}", g).replace("{$ip$}", p).replace("{$time$}", o).replace("{$feedback$}", f).replace("{$content$}", m); var r = $j("divComments").html(); if (r == "暂无评论") { r = "" } $j("divComments").html(q + r); $j("spCommentCount").html(l); $a(j, 1); emptyText("tbCmt") } else { $a(j) } } } showProc(e, false) }) } function writeComment(a, b) { $.post("ajax.ashx@action=getcomment&t=" + Math.random(), { oid: a, mark: b }, function (e) { var h = $(e).find("count").text(); $j("spCommentCount").html(h); var n = $(e).find("comment"); var m = ""; var k = "<dl><dd>{$username$}<span class='ip'>IP：{$ip$}</span>时间：{$time$}</dd><dd class='c666 con mt8 mb10'>{$content$}</dd><dd class='huifu'><h5>管理员回复：</h5><div>{$feedback$}</div></dd></dl>"; for (var f = 0; f < n.length; ++f) { var o = $(n[f]); var d = o.find("username").text(); var g = o.find("content").text(); var l = o.find("ip").text(); var j = o.find("inputTime").text(); var c = o.find("feedback").text(); m += k.replace("{$username$}", d).replace("{$ip$}", l).replace("{$time$}", j).replace("{$content$}", g).replace("{$feedback$}", c) } if (m.length > 0) { $j("divComments").html(m) } else { $j("divComments").html("暂无评论") } }) } function addHistory(a, b) { $.get("ajax.ashx@action=addhistory&t=" + Math.random(), { oid: a, mark: b }) } function getAd(b, a) { $.post("ajax.ashx@action=getadd", { keyname: b }, function (c) { $j(a).html(c) }) } function getVideo(a) { $.post("ajax.ashx@action=getvideo", { videoKey: a }, function (c) { var b = $j("divVideo"); if (c.length == 0) { b.slideUp(80) } else { b.html(c); $(".prod_attrs").toggleClass("prod_attrs").toggleClass("prod_attrs_b") } }) } function getOrderAnns() { $.get("ajax.ashx@action=getorderanns", function (a) { $j("divOrderAnns").html(a) }) } function getEndingRemark() { $.get("ajax.ashx@action=getendingremark", function (a) { $j("divEndingRemark").html(a) }) } function getHistory(a) { $.post("ajax.ashx@action=gethistory&t=" + Math.random(), { mark: a }, function (b) { if (b.length == 0) { b = "<li>&nbsp;&nbsp;无浏览历史</li>" } $j("divHistoryCntr").html(b + "<div class='clear'></div>") }) } function getHits(a, b) { $.post("/ajax.ashx?action=gethits", { mark: b, oid: a }, function (c) { $j("cntrHits").html(c) }) } function getHelpStatic(a) { $.post("/ajax.ashx?action=helpsatisfaction&t=" + Math.random(), { oid: a }, function (k) { var b = [parseInt(gav(k, "1")), parseInt(gav(k, "2")), parseInt(gav(k, "3"))]; var g = b[0] + b[1] + b[2]; if (g == 0) { g = 1 } var f = 100; for (var c = 0; c < b.length; ++c) { var e = (b[c] / g).toFixed(2); var d = f * e; if (d == 0) { d = 1 } var j = "<div class='static_graph' style='height:" + d + "px;'></div><div class='static_w'>" + (e * 100).toFixed(2) + "%</div>"; $j("cntrStatic_" + c).html(j) } }) } function submitHelpUse(c, b) { showProc(c); var a = $("input[name=use]:checked").val(); $.post("ajax.ashx@action=helpuseful&t=" + Math.random(), { oid: b, notion: a }, function (d) { if (gav(d, "state") == "0") { $a(gav(d, "msg")) } else { $a(gav(d, "msg"), 1); getHelpStatic(b) } showProc(c, false) }) } function getSimilarArticle(a) { $.post("ajax.ashx@action=getsmilararticle&t=" + Math.random(), { sid: a }, function (b) { $j("cntrSimilarArticle").html(b) }) } function getLastArticle() { $.post("ajax.ashx@action=getlastarticle", function (a) { $j("cntrLastArticle").html(a) }) } function cleanHistory(b, a) { $.post("ajax.ashx@action=cleanhistory", { mark: b }, function (c) { $j("divHistoryCntr").html("<li>&nbsp;&nbsp;无浏览历史</li>") }) } function subscription(d, a) { if (a == null) { a = "txtSubscriptionEmail" } var c = $.trim($j(a).val()); var b = /\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/; if (c.length == 0) { $a("E-Mail 不可为空"); $j(a).focus(); return false } if (!b.test(c)) { $a("E-Mail 格式错误。"); $j(a).focus(); return false } showProc(d); $.post("/ajax.ashx?action=subscription&t=" + Math.random(), { email: c }, function (g) { var f = gav(g, "state"); var e = gav(g, "msg"); if (f == "1") { $a(e, 1) } else { $a(e) } showProc(d, false) }) } function userFeedback(c) { var a = $tv("txtFdTitle"); var b = $tv("txtFdShortDesc"); if (a.length == 0 || b.length == 0) { $a("内容或标题不可为空。"); return false } showBgProc(true, "正在提交..."); $.post("/ajax.ashx?action=userfeedback&t=" + Math.random(), { title: a, shortDesc: b }, function (f) { var e = gav(f, "state"); var d = gav(f, "msg"); if (e == "1") { showMsgPage("<li>您的意见提交成功，感谢您的意见，有您的支持，我们会做得更好。</li>", 1, "/user/faq.aspx", "意见/反馈", "/user/faq.aspx"); return } else { if (d.length > 0) { $a(d) } else { $a(f) } } showBgProc(false) }) } function checkAuthority(b, a) { $.post("/ajax.ashx?action=checkauthority&t=" + Math.random(), { authIDs: b }, function (c) { if (c == "1") { $j("div___________Perm").hide(); document.oncontextmenu = function () { return true }; document.onselectstart = function () { return true } } else { showMsgPage("您不具有查看 " + a + " 的权限。"); return } }) } function changeFavColumn(c, a) { var b = getCheckedVal(a); if (b.length == 0) { $a("无选中项。"); return } showProc(c); $.post("/ajax.ashx?action=changefavcolumn&t=" + Math.random(), { ids: b, targetId: c.value }, function (f) { var e = gav(f, "state"); var d = gav(f, "msg"); if (e == "1") { location.reload() } else { } }); showProc(c, false) } function getRecommentProductByHistory(a) { $.post("/ajax.ashx?action=GetRecommentProductByHistory&t=" + Math.random(), { oid: a }, function (c) { var b = $j("divHistoryRecommentCntr"); if (c.length == 0) { b.remove() } else { b.html(c) } }) } function getRecommentProjectByHistory(a) { $.post("/ajax.ashx?action=GetRecommentProjectByHistory&t=" + Math.random(), { oid: a }, function (c) { var b = $j("divHistoryRecommentCntr"); if (c.length == 0) { b.remove() } else { b.html(c) } }) } function getRelevantSales(a) { $.post("/ajax.ashx?action=GetRelevantSales&t=" + Math.random(), { oid: a }, function (c) { var b = $j("divRelevantSalesCntr"); if (c.length == 0) { b.remove() } else { b.html(c) } }) } function getRelevantViewed(a) { $.post("/ajax.ashx?action=GetRelevantViewed&t=" + Math.random(), { oid: a }, function (c) { var b = $j("divRelevantViewedCntr"); if (c.length == 0) { b.remove() } else { b.html(c) } }) } function getRelevantViewedProject(a) { $.post("/ajax.ashx?action=GetRelevantViewedProject&t=" + Math.random(), { oid: a }, function (c) { var b = $j("divRelevantViewedCntr"); if (c.length == 0) { b.remove() } else { b.html(c) } }) } function getRelevantViewedDownload(a) { $.post("/ajax.ashx?action=GetRelevantViewedDownload&t=" + Math.random(), { oid: a }, function (c) { var b = $j("divRelevantViewedCntr"); if (c.length == 0) { b.remove() } else { b.html(c) } }) } function delInitationlog(c, a) { var b = getCheckedVal(a); if (b.length == 0) { $a("无选中项。"); return } showBgProc(); $.post("/ajax.ashx?action=DelInitationlog&t=" + Math.random(), { ids: b }, function (e) { if (gav(e, "state") == "1") { var d = $j(a).find("input[name=item]:checked"); d.each(function (f) { $(this).parent().parent().remove() }) } else { $a(gav(e, "msg")) } showBgProc(false) }) } function sendInvitation(c) { var b = $j(c); var a = $j("txtEmail").val(); if (a == null || a.length == 0) { $a("电子邮箱地址不可为空。"); return } if (!PTN_EMAIL.test(a)) { $a("电子邮箱地址格式不正确。"); return } showProc(c); $.post("ajax.ashx@action=sendinvitation&t=" + Math.random(), { _email: a }, function (f) { var e = gav(f, "state"); var d = gav(f, "msg"); if (e == "1") { showMsgPage(d, 1, "user/inviteuserlist.aspx", "邀请函列表", "user/inviteuserlist.aspx") } else { $a(d); showProc(c, false) } }) } function fillReportCategories() { $.get("ajax.ashx@action=getreportcategories&t=" + Math.random(), function (d) { var a = d.split("$$"); var c = '<option value="">请选择...</option>'; for (var b = 0; b < a.length; ++b) { c += '<option value="' + a[b] + '">' + a[b] + "</option>" } $j("RPT_tdCats").html('<select id="RPT_cats">' + c + "</select>") }) } function fillLeavewordCategories() { $.get("ajax.ashx@action=getleavewordcategories&t=" + Math.random(), function (d) { var a = d.split("$$"); var c = '<option value="">请选择...</option>'; for (var b = 0; b < a.length; ++b) { c += '<option value="' + a[b] + '">' + a[b] + "</option>" } $j("LEAVEWORD_tdCats").html('<select id="LEAVEWORD_cats">' + c + "</select>") }) } function sendLeaveword(a) { var h = $j("LEAVEWORD_cats").val(); var j = $v("LEAVEWORD_txtTitle"); var c = $v("LEAVEWORD_txtTel"); var f = $v("LEAVEWORD_txtMobile"); var d = $v("LEAVEWORD_txtContact"); var g = $v("LEAVEWORD_txtEmail"); var e = $v("LEAVEWORD_txtShortDesc"); var b = ""; if (j == "") { b += "<li>标题不可为空</li>" } if (d == "") { b += "<li>联系人不可为空</li>" } if (g == "") { b += "<li>电子邮箱地址不可为空</li>" } else { if (!PTN_EMAIL.test(g)) { b += "<li>电子邮箱地址格式错误</li>" } } if (h == "") { b += "<li>留言类型必选</li>" } if (b.length > 0) { $a(b); return } showProc(a); $.post("ajax.ashx@action=sendleaveword&t=" + Math.random(), { title: j, cat: h, contact: d, email: g, shortDesc: e, tel: c, mobile: f }, function (m) { var l = gav(m, "state"); var k = gav(m, "msg"); if (l == "1") { $a(k, 1) } else { $a(k) } showProc(a, false) }) } function sendReprots(g) { var c = $j("RPT_cats").val(); var b = document.title; var e = document.URL; var f = $v("RPT_txtContact"); var d = $v("RPT_txtEmail"); var a = $v("RPT_txtShortDesc"); if (c.length == 0) { $a("请选择报告分类。"); return } showProc(g); $.post("ajax.ashx@action=sendreports&t=" + Math.random(), { title: b, url: e, cat: c, contact: f, email: d, shortDesc: a }, function (k) { var j = gav(k, "state"); var h = gav(k, "msg"); if (j == "1") { $a(h, 1) } else { $a(h) } showProc(g, false) }) } function directPay(a) { var f = $v("DIR_PAY_txtPayer"); var k = $v("DIR_PAY_txtEmail"); var h = $v("DIR_PAY_txtTel"); var j = $v("DIR_PAY_txtMobile"); var e = $v("DIR_PAY_txtSalesManName"); var d = $v("DIR_PAY_txtMoney"); var b = $v("DIR_PAY_txtUse"); var c = $v("DIR_PAY_ddlPayment"); var g = ""; if (f.length == 0) { g += "<li>付款人不可为空。</li>" } if (k == "") { g += "<li>电子邮箱地址不可为空</li>" } else { if (!PTN_EMAIL.test(k)) { g += "<li>电子邮箱地址格式错误</li>" } } if (d.length == 0) { g += "<li>付款金额不可为空。</li>" } else { if (!PTN_FLOAT.test(d)) { g += "<li>付款金额必须为数字，如89.00。</li>" } } if (b.length == 0) { g += "<li>款项用途不可为空。</li>" } if (c.length == 0) { g += "<li>请选择付款方式。</li>" } if (g.length > 0) { $a(g); return } showProc(a); $.post("/ajax.ashx?action=DirectPay&t=" + Math.random(), { payer: f, email: k, tel: h, mobile: j, salesMan: e, _money: d, _use: b, payment: c }, function (n) { var m = gav(n, "state"); var l = gav(n, "msg"); if (m == "1") { location.href = "/Paycenter/PayDirectConfirm.aspx"; return } else { $a(l) } showProc(a, false) }) } function submitOrder(a, e) { showProc(a); var d = $j("txtContact").val(); var j = $j("txtCompName").val(); var k = $j("txtTel").val(); var h = $j("txtMobile").val(); var m = $j("txtEmail").val(); var c = $j("txtAddr").val(); var g = $j("txtContent").val(); var n = $j("txtValidate").val(); var f = ""; if (d.length == 0) { f += "<p>联系人不可为空</p>" } if (h.length == 0) { f += "<p>手机不可为空</p>" } var l = /^\d{11,13}$/; if (h.length > 0 && !l.test(h)) { f += "<p>手机格式错误</p>" } var b = /\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/; if (m.length > 0 && !b.test(m)) { f += "<p>E-Mail格式错误</p>" } if (g.length == 0) { f += "<p>采购意向描述不可为空</p>" } if (n.length == 0) { f += "<p>验证码不可为空</p>" } if (f.length > 0) { $a(f); showProc(a, false); return } $.post("/ajax.ashx?action=submitorder&t=" + Math.random(), { oid: e, contact: d, compName: j, tel: k, mobile: h, email: m, addr: c, content: g, vali: n }, function (q) { var p = gav(q, "state"); var o = gav(q, "msg"); if (p == "1") { $a(o, 1); emptyText("tbForm1"); document.getElementById("imgvalidate").src = "/Tools/ValidCodes.aspx?" + new Date().getTime() } else { $a(o); if ($.trim(o).indexOf("验证码错误") != -1) { document.getElementById("imgvalidate").src = "/Tools/ValidCodes.aspx?" + new Date().getTime() } else { emptyText("tbForm1") } } }); showProc(a, false) } function getAgentHelpStatic(a) { $.post("/ajax.ashx?action=agenthelpsatisfaction&t=" + Math.random(), { oid: a }, function (k) { var b = [parseInt(gav(k, "1")), parseInt(gav(k, "2")), parseInt(gav(k, "3"))]; var g = b[0] + b[1] + b[2]; if (g == 0) { g = 1 } var f = 100; for (var c = 0; c < b.length; ++c) { var e = (b[c] / g).toFixed(2); var d = f * e; if (d == 0) { d = 1 } var j = "<div class='static_graph' style='height:" + d + "px;'></div><div class='static_w'>" + (e * 100).toFixed(2) + "%</div>"; $j("cntrStatic_" + c).html(j) } }) } function submitAgentHelpUse(c, b) { showProc(c); var a = $("input[name=use]:checked").val(); $.post("ajax.ashx@action=agenthelpuseful&t=" + Math.random(), { oid: b, notion: a }, function (d) { if (gav(d, "state") == "0") { $a(gav(d, "msg")) } else { $a(gav(d, "msg"), 1); getAgentHelpStatic(b) } showProc(c, false) }) } function showProductInfo(h, c, g) { var f = null; var e = null; var a = null; var d = null; $(h).hover(function () { f = new Date(); b() }, function () { window.clearInterval(a) }); function b() { a = window.setInterval(function () { e = new Date(); d = e - f; if (d > 400) { if ($(h).parent().parent().next().attr("class") == "mesbook4" || $(h).parent().parent().next().attr("class") == "mesbook40") { if ($(h).parent().parent().next().is(":visible")) { return } else { $(h).parent().parent().next().show() } } else { $.post("/ajax.ashx?action=showProductInfo&t=" + Math.random(), { oid: c, index: g }, function (j) { if ($(h).parent().parent().next().attr("class") == "mesbook4" || $(h).parent().parent().next().attr("class") == "mesbook40") { return } else { $(h).parent().parent().after(j); return } }) } } }, 450) } } function showProductInfos(g, c) { var f = null; var e = null; var a = null; var d = null; $(g).hover(function () { f = new Date(); b() }, function () { window.clearInterval(a) }); function b() { a = window.setInterval(function () { e = new Date(); d = e - f; if (d > 400) { if ($(g).parent().parent().next().attr("class") == "mesbook44") { if ($(g).parent().parent().next().is(":visible")) { return } else { $(g).parent().parent().next().show() } } else { $.post("ajax.ashx@action=showproductinfos&t=" + Math.random(), { oid: c }, function (h) { if ($(g).parent().parent().next().attr("class") == "mesbook44") { return } else { $(g).parent().parent().after(h); return } }) } } }, 450) } } function hideProductInfo(a) { if ($(a).parent().parent().next().attr("class") == "mesbook4" || $(a).parent().parent().next().attr("class") == "mesbook40" || $(a).parent().parent().next().attr("class") == "mesbook44") { $(a).parent().parent().next().mouseover(function () { $(a).parent().parent().next().show(); return }); $(a).parent().parent().next().mouseout(function () { $(a).parent().parent().next().hide(); return }); $(a).parent().parent().next().hide() } } function showProductTips(b) { var a = $j("div_nsw_tips"); if (a.length == 0) { var c = "<div class='mesbook5' id='div_nsw_tips'><h1><a href='javascript:void(0)' onclick=\"$(this).parent().parent().fadeOut(80);hideFullBg('div_nsw_tips_bg')\"><img src='" + SKIN_PATH + "img/ico9_close.gif' /></a>产品预定</h1><h4>告诉我该产品的好消息</h4><div class='con'>您需要等待该产品的上架吗？一旦该产品的价格降价之后，我们会第一时间把该商品的价格清单发送到您的电子邮件。</div> <h5>如果打折则发送电子邮件给我</h5><div class='inp'><input id='rdoTip1' type='radio' name='rdoTips' value='0' checked='true' /><label for='rdoTip1'>仅仅当前该产品</label></div><div class='inp'><input id='rdoTip2' type='radio' name='rdoTips' value='1' /><label for='rdoTip2'>当前产品所属分类</label></div><div class='inp'><input  id='rdoTip3' type='radio' name='rdoTips' value='2' /><label for='rdoTip3'>所有打折清单</label></div><div class='inp'><span>Email:</span><input type='text' id='txtEmail' name='txtEmail'  class='text' /><input id='txtHide' name='txtHide' type='hidden' value='" + b + "' /></div><div class='inp'><span>简述:</span><textarea id='txtContent' name='txtContent'class='textarea'></textarea></div><div class='mes_btn'><input type='button' class='b61' value='提  交' onclick=\"submitProductTips('txtHide','txtEmail','txtContent','rdoTips')\" /><input type='button' class='b62' value='取  消' onclick=\"$(this).parent().parent().fadeOut(80);hideFullBg('div_nsw_tips_bg')\" /></div></div>"; $(document.body).append(c) } setCM("div_nsw_tips"); showFullBg("div_nsw_tips_bg"); relocation("div_nsw_tips") } function submitProductTips(e, f, c, d) { var e = $j("txtHide").val(); var f = $j("txtEmail").val(); var c = $j("txtContent").val(); var a = $("input[name=rdoTips]:checked").val(); if (c.length > 500) { $a("简述太长，不能超过500个字节，请填写简短描述") } var b = /\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/; if (f.length == 0) { $a("E-Mail 不可为空"); return false } if (!b.test(f)) { $a("E-Mail 格式错误"); return false } $.post("ajax.ashx@action=postproducttips&t=" + Math.random(), { oid: e, email: f, content: c, state: a }, function (g) { if (gav(g, "state") == "1") { $a(gav(g, "msg"), 1) } else { $a(gav(g, "msg")) } }); $j("div_nsw_tips").hide(); hideFullBg("div_nsw_tips_bg") } function showMyWish(b) { var a = $j("div_nsw_wishs"); if (a.length == 0) { var c = '<div class="mesbook6" id="div_nsw_wishs"></div>'; $(document.body).append(c) } $.post("ajax.ashx@action=showmywish&t=" + Math.random(), { oid: b }, function (d) { $j("div_nsw_wishs").html(d) }); setCM("div_nsw_wishs"); showFullBg("div_nsw_wishs_bg"); relocation("div_nsw_wishs") } function submitProductWishs(b, c, a) { var b = $j("txtHide").val(); var c = $j("txtAttr").html(); var a = $j("txtNum").val(); $.post("ajax.ashx@action=postproductwishs&t=" + Math.random(), { oid: b, attr: c, num: a }, function (d) { if (gav(d, "state") == "1") { $a(gav(d, "msg"), 1) } else { $a(gav(d, "msg")) } }); $j("div_nsw_wishs").hide(); hideFullBg("div_nsw_wishs_bg") } function sendGetProductsNotify(c) { var b = $j("ddlProductsColumns").val(); var a = $j("txtSearch").val(); if (a == "关键词") { a = "" } $.post("ajax.ashx@action=sendgetproductsbycolumn&t=" + Math.random(), { columnID: b, searchText: a }, function (d) { InitDropdownlist(document.getElementById("PackageSelectList"), "请选择关联资讯", "0", d) }) } function InitDropdownlist(e, d, c, f) { var a = e.options.length; for (i = 0; i < a; i++) { e.remove(0) } var b = f.split("||"); a = b.length; if (a) { for (i = 0; i < a - 1; i++) { text_value = b[i].split("$$"); text = text_value[1]; value = text_value[0]; e.add(new Option(text, value)) } } } function userorder(a) { var b = $tv("txtname"); var e = $tv("txttitle"); var c = $tv("txtemail"); var j = $tv("txttel"); var f = $tv("txtcontent"); var h = $tv("txtaddress"); var k = $tv("txtenddate"); var g = $("#PackagePickList").val(); if (e == "") { $a("定单名称不能为空", "txttitle"); return } if (b == "") { $a("下单人姓名不能为空", "txtname"); return } if (j == "") { $a("联系电话不能为空", "txttel"); return } if (h == "") { $a("联系地址不能为空", "txtaddress"); return } if (k == "") { $a("到货时间不能为空", "txtenddate"); return } if (f == "" || f.length > 1000) { $a("详细描述不能为空或者大于1000字", "txtcontent"); return } else { var l = $.trim($(a).attr("value")); var d = /\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/; if (!d.test(c)) { $a("E-Mail错误"); return false } } $.post("ajax.ashx@action=agentorder&t=" + Math.random(), { s_name: b, s_title: e, s_email: c, s_tel: j, s_content: f, s_address: h, s_enddate: k, s_IDList: g }, function (o) { var n = gav(o, "state"); var m = gav(o, "msg"); if (n == "1") { showMsgPage("<li>定单提交成功，我们会尽快与您联系，谢谢！</li>", 1, "user/userorder.aspx", "在线定单", "user/userorder.aspx"); return } else { if (m.length > 0) { $a(m) } else { $a(o) } } }) } function delAgentOrder(c, a) { var b = getCheckedVal(a); if (b.length == 0) { $a("无选中项。"); return } showBgProc(); $.post("ajax.ashx@action=delagentorder&t=" + Math.random(), { ids: b }, function (e) { if (gav(e, "state") == "1") { var d = $j(a).find("input[name=item]:checked"); d.each(function (f) { $(this).parent().parent().remove() }); $a(gav(e, "msg"), 1) } else { $a(gav(e, "msg")) } showBgProc(false) }) } function AddApply(a) { var b = document.getElementById("TxtType").selectedIndex; var c = $tv("TxtUrl"); var e = $tv("TxtName"); var d = $tv("TxtPhotoPath"); var h = $tv("TxtMsg"); var k = $tv("TxtUserName"); var f = $tv("TxtTel"); var g = $tv("TxtEmail"); var j = $tv("TxtQQ"); if (c == "" || c == "http://") { $a("请输入网址！", "TxtUrl"); return } if (e == "") { $a("请输入网站名称！", "TxtName"); return } if (h.length > 400) { $a("网站简况不能大于400字！", "txtUsername"); return } $.post("ajax.ashx@action=apply&t=" + Math.random(), { Type: b, Url: c, Name: e, PhotoPath: d, Content: h, UserName: k, Phone: f, Email: g, QQ: j }, function (l) { if (gav(l, "state") == "1") { $a(gav(l, "msg")); $("#tbForm input[type=text],tbForm textarea").val(""); } else { $a(gav(l, "msg")) } }) } function AddCompare(b) { var c = false; if (b.checked) { c = true; $(b).next().next().next().show() } else { c = false; $(b).next().next().next().hide() } var a = $(b).val(); $.post("ajax.ashx@action=addcompare&t=" + Math.random(), { ids: a, flag: c }, function (g) { if (gav(g, "state") == "1") { var f = gav(g, "newcookie"); var d = new Array(); d = f.split(","); if (d.length > 0) { for (var e = 0; e < d.length; e++) { if (e == d.length - 1) { $(".pro_main").find("input[id=" + d[e] + "]").show() } else { $(".pro_main").find("input[id=" + d[e] + "]").hide() } } } } }) } function DelOneCompare(b) { var a = $(b).attr("id"); $.post("ajax.ashx@action=delonecompare&t=" + Math.random(), { ids: a }, function (c) { if (gav(c, "state") == "1") { window.location = "product/compare.aspx" } else { showMsgPage("<li>产品对比车中不存在对比的产品记录，请选择需要对比的产品</li>", 0, "default.htm", "首页", "default.htm") } }) } function DelAllCompare() { $.post("ajax.ashx@action=delallcompare&t=" + Math.random(), {}, function (a) { showMsgPage("<li>产品对比车中所有产品已移除，您可以继续挑选产品进行比较</li>", 1, "default.htm", "首页", "default.htm") }) } function addDownload(b, a) { $.post("ajax.ashx@action=adddownload&t=" + Math.random(), { oid: b }, function (c) { if (gav(c, "state") == "1") { window.location = a } else { $a(gav(c, "msg")) } }) } function getNewProduct() { $.post("ajax.ashx@action=getnewproduct&t=" + Math.random(), function (a) { $("#newpro").html(a); $("#newpro h5").mouseover(function () { $(this).addClass("cur").siblings("h5").removeClass("cur").end().next("dl").show().siblings("dl").hide() }).eq(0).trigger("mouseover") }) } function getSubSiteInfos() { $.post("ajax.ashx@action=subsiteinfos&t=" + Math.random(), { domain: document.domain }, function (c) { var a = gav(c, "phone"); var b = gav(c, "address"); $("#phones").html(a) }) } function getSubSiteInfo() { $.post("ajax.ashx@action=subsiteinfo&t=" + Math.random(), { domain: document.domain }, function (a) { if (a) { $("#site ul").html(a) } else { $("#site").remove() } }) } function IsURL(c) { var b = "^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$"; var a = new RegExp(b); if (a.test(c)) { return (true) } else { return (false) } };
$(function () { if (!$.trim($("div.prodesc").text())) { $("div.prodesc").remove(); } });
/*MSCLASS.js*/
function Marquee() { this.ID = document.getElementById(arguments[0]); if (!this.ID) { alert('您要设置的"' + arguments[0] + '"初始化错误\r\n请检查标签ID设置是否正确!'); this.ID = -1; return } this.Direction = this.Width = this.Height = this.DelayTime = this.WaitTime = this.CTL = this.StartID = this.Stop = this.MouseOver = 0; this.Step = 1; this.Timer = 30; this.DirectionArray = { top: 0, up: 0, bottom: 1, down: 1, left: 2, right: 3 }; if (typeof arguments[1] == "number" || typeof arguments[1] == "string") { this.Direction = arguments[1] } if (typeof arguments[2] == "number") { this.Step = arguments[2] } if (typeof arguments[3] == "number") { this.Width = arguments[3] } if (typeof arguments[4] == "number") { this.Height = arguments[4] } if (typeof arguments[5] == "number") { this.Timer = arguments[5] } if (typeof arguments[6] == "number") { this.DelayTime = arguments[6] } if (typeof arguments[7] == "number") { this.WaitTime = arguments[7] } if (typeof arguments[8] == "number") { this.ScrollStep = arguments[8] } this.ID.style.overflow = this.ID.style.overflowX = this.ID.style.overflowY = "hidden"; this.ID.noWrap = true; this.IsNotOpera = (navigator.userAgent.toLowerCase().indexOf("opera") == -1); if (arguments.length >= 7) { this.Start() } } Marquee.prototype.Start = function () { if (this.ID == -1) { return } if (this.WaitTime < 800) { this.WaitTime = 800 } if (this.Timer < 20) { this.Timer = 20 } if (this.Width == 0) { this.Width = parseInt(this.ID.style.width) } if (this.Height == 0) { this.Height = parseInt(this.ID.style.height) } if (typeof this.Direction == "string") { this.Direction = this.DirectionArray[this.Direction.toString().toLowerCase()] } this.HalfWidth = Math.round(this.Width / 2); this.HalfHeight = Math.round(this.Height / 2); this.BakStep = this.Step; this.ID.style.width = this.Width + "px"; this.ID.style.height = this.Height + "px"; if (typeof this.ScrollStep != "number") { this.ScrollStep = this.Direction > 1 ? this.Width : this.Height } var d = "<table cellspacing='0' cellpadding='0' style='border-collapse:collapse;display:inline;'><tr><td noWrap=true style='white-space: nowrap;word-break:keep-all;'>MSCLASS_TEMP_HTML</td><td noWrap=true style='white-space: nowrap;word-break:keep-all;'>MSCLASS_TEMP_HTML</td></tr></table>"; var b = "<table cellspacing='0' cellpadding='0' style='border-collapse:collapse;'><tr><td>MSCLASS_TEMP_HTML</td></tr><tr><td>MSCLASS_TEMP_HTML</td></tr></table>"; var e = this; e.tempHTML = e.ID.innerHTML; if (e.Direction <= 1) { e.ID.innerHTML = b.replace(/MSCLASS_TEMP_HTML/g, e.ID.innerHTML) } else { if (e.ScrollStep == 0 && e.DelayTime == 0) { e.ID.innerHTML += e.ID.innerHTML } else { e.ID.innerHTML = d.replace(/MSCLASS_TEMP_HTML/g, e.ID.innerHTML) } } var f = this.Timer; var a = this.DelayTime; var c = this.WaitTime; e.StartID = function () { e.Scroll() }; e.Continue = function () { if (e.MouseOver == 1) { setTimeout(e.Continue, a) } else { clearInterval(e.TimerID); e.CTL = e.Stop = 0; e.TimerID = setInterval(e.StartID, f) } }; e.Pause = function () { e.Stop = 1; clearInterval(e.TimerID); setTimeout(e.Continue, a) }; e.Begin = function () { e.ClientScroll = e.Direction > 1 ? e.ID.scrollWidth / 2 : e.ID.scrollHeight / 2; if ((e.Direction <= 1 && e.ClientScroll <= e.Height + e.Step) || (e.Direction > 1 && e.ClientScroll <= e.Width + e.Step)) { e.ID.innerHTML = e.tempHTML; delete (e.tempHTML); return } delete (e.tempHTML); e.TimerID = setInterval(e.StartID, f); if (e.ScrollStep < 0) { return } e.ID.onmousemove = function (g) { if (e.ScrollStep == 0 && e.Direction > 1) { var g = g || window.event; if (window.event) { if (e.IsNotOpera) { e.EventLeft = g.srcElement.id == e.ID.id ? g.offsetX - e.ID.scrollLeft : g.srcElement.offsetLeft - e.ID.scrollLeft + g.offsetX } else { e.ScrollStep = null; return } } else { e.EventLeft = g.layerX - e.ID.scrollLeft } e.Direction = e.EventLeft > e.HalfWidth ? 3 : 2; e.AbsCenter = Math.abs(e.HalfWidth - e.EventLeft); e.Step = Math.round(e.AbsCenter * (e.BakStep * 2) / e.HalfWidth) } }; e.ID.onmouseover = function () { if (e.ScrollStep == 0) { return } e.MouseOver = 1; clearInterval(e.TimerID) }; e.ID.onmouseout = function () { if (e.ScrollStep == 0) { if (e.Step == 0) { e.Step = 1 } return } e.MouseOver = 0; if (e.Stop == 0) { clearInterval(e.TimerID); e.TimerID = setInterval(e.StartID, f) } } }; setTimeout(e.Begin, c) }; Marquee.prototype.Scroll = function () { switch (this.Direction) { case 0: this.CTL += this.Step; if (this.CTL >= this.ScrollStep && this.DelayTime > 0) { this.ID.scrollTop += this.ScrollStep + this.Step - this.CTL; this.Pause(); return } else { if (this.ID.scrollTop >= this.ClientScroll) { this.ID.scrollTop -= this.ClientScroll } this.ID.scrollTop += this.Step } break; case 1: this.CTL += this.Step; if (this.CTL >= this.ScrollStep && this.DelayTime > 0) { this.ID.scrollTop -= this.ScrollStep + this.Step - this.CTL; this.Pause(); return } else { if (this.ID.scrollTop <= 0) { this.ID.scrollTop += this.ClientScroll } this.ID.scrollTop -= this.Step } break; case 2: this.CTL += this.Step; if (this.CTL >= this.ScrollStep && this.DelayTime > 0) { this.ID.scrollLeft += this.ScrollStep + this.Step - this.CTL; this.Pause(); return } else { if (this.ID.scrollLeft >= this.ClientScroll) { this.ID.scrollLeft -= this.ClientScroll } this.ID.scrollLeft += this.Step } break; case 3: this.CTL += this.Step; if (this.CTL >= this.ScrollStep && this.DelayTime > 0) { this.ID.scrollLeft -= this.ScrollStep + this.Step - this.CTL; this.Pause(); return } else { if (this.ID.scrollLeft <= 0) { this.ID.scrollLeft += this.ClientScroll } this.ID.scrollLeft -= this.Step } break } };
/*ScrollPicleft.js*/
var sina = { $: function (objName) { if (document.getElementById) { return eval('document.getElementById("' + objName + '")') } else { return eval("document.all." + objName) } }, isIE: navigator.appVersion.indexOf("MSIE") != -1 ? true : false, addEvent: function (a, c, b) { if (a.attachEvent) { a.attachEvent("on" + c, b) } else { a.addEventListener(c, b, false) } }, delEvent: function (a, c, b) { if (a.detachEvent) { a.detachEvent("on" + c, b) } else { a.removeEventListener(c, b, false) } }, readCookie: function (d) { var e = "", a = d + "="; if (document.cookie.length > 0) { var c = document.cookie.indexOf(a); if (c != -1) { c += a.length; var b = document.cookie.indexOf(";", c); if (b == -1) { b = document.cookie.length } e = unescape(document.cookie.substring(c, b)) } } return e }, writeCookie: function (d, a, f, g) { var e = "", b = ""; if (f != null) { e = new Date((new Date).getTime() + f * 3600000); e = "; expires=" + e.toGMTString() } if (g != null) { b = ";domain=" + g } document.cookie = d + "=" + escape(a) + e + b }, readStyle: function (b, a) { if (b.style[a]) { return b.style[a] } else { if (b.currentStyle) { return b.currentStyle[a] } else { if (document.defaultView && document.defaultView.getComputedStyle) { var c = document.defaultView.getComputedStyle(b, null); return c.getPropertyValue(a) } else { return null } } } } }; function ScrollPicleft(b, g, f, e) { this.scrollContId = b; this.arrLeftId = g; this.arrRightId = f; this.dotListId = e; this.dotClassName = "dotItem"; this.dotOnClassName = "dotItemOn"; this.dotObjArr = []; this.pageWidth = 0; this.frameWidth = 0; this.speed = 10; this.space = 10; this.pageIndex = 0; this.autoPlay = true; this.autoPlayTime = 5; var a, d, c = "ready"; this.stripDiv = document.createElement("DIV"); this.listDiv01 = document.createElement("DIV"); this.listDiv02 = document.createElement("DIV"); if (!ScrollPicleft.childs) { ScrollPicleft.childs = [] } this.ID = ScrollPicleft.childs.length; ScrollPicleft.childs.push(this); this.initialize = function () { if (!this.scrollContId) { throw new Error("必须指定scrollContId."); return } this.scrollContDiv = sina.$(this.scrollContId); if (!this.scrollContDiv) { throw new Error('scrollContId不是正确的对象.(scrollContId = "' + this.scrollContId + '")'); return } this.scrollContDiv.style.width = this.frameWidth + "px"; this.scrollContDiv.style.overflow = "hidden"; this.listDiv01.innerHTML = this.listDiv02.innerHTML = this.scrollContDiv.innerHTML; this.scrollContDiv.innerHTML = ""; this.scrollContDiv.appendChild(this.stripDiv); this.stripDiv.appendChild(this.listDiv01); this.stripDiv.appendChild(this.listDiv02); this.stripDiv.style.overflow = "hidden"; this.stripDiv.style.zoom = "1"; this.stripDiv.style.width = "32766px"; var l = navigator.userAgent.toUpperCase().indexOf("MSIE") == -1 ? false : true; if (l) { this.listDiv01.style.styleFloat = "left"; this.listDiv02.style.styleFloat = "left" } else { this.listDiv01.style.cssFloat = "left"; this.listDiv02.style.cssFloat = "left" } sina.addEvent(this.scrollContDiv, "mouseover", Function("ScrollPicleft.childs[" + this.ID + "].stop()")); sina.addEvent(this.scrollContDiv, "mouseout", Function("ScrollPicleft.childs[" + this.ID + "].play()")); if (this.arrLeftId) { this.arrLeftObj = sina.$(this.arrLeftId); if (this.arrLeftObj) { sina.addEvent(this.arrLeftObj, "mousedown", Function("ScrollPicleft.childs[" + this.ID + "].rightMouseDown()")); sina.addEvent(this.arrLeftObj, "mouseup", Function("ScrollPicleft.childs[" + this.ID + "].rightEnd()")); sina.addEvent(this.arrLeftObj, "mouseout", Function("ScrollPicleft.childs[" + this.ID + "].rightEnd()")) } } if (this.arrRightId) { this.arrRightObj = sina.$(this.arrRightId); if (this.arrRightObj) { sina.addEvent(this.arrRightObj, "mousedown", Function("ScrollPicleft.childs[" + this.ID + "].leftMouseDown()")); sina.addEvent(this.arrRightObj, "mouseup", Function("ScrollPicleft.childs[" + this.ID + "].leftEnd()")); sina.addEvent(this.arrRightObj, "mouseout", Function("ScrollPicleft.childs[" + this.ID + "].leftEnd()")) } } if (this.dotListId) { this.dotListObj = sina.$(this.dotListId); if (this.dotListObj) { var h = Math.round(this.listDiv01.offsetWidth / this.frameWidth + 0.4), k, j; for (k = 0; k < h; k++) { j = document.createElement("span"); this.dotListObj.appendChild(j); this.dotObjArr.push(j); if (k == this.pageIndex) { j.className = this.dotClassName } else { j.className = this.dotOnClassName } j.title = "第" + (k + 1) + "页"; sina.addEvent(j, "click", Function("ScrollPicleft.childs[" + this.ID + "].pageTo(" + k + ")")) } } } if (this.autoPlay) { this.play() } }; this.leftMouseDown = function () { if (c != "ready") { return } c = "floating"; d = setInterval("ScrollPicleft.childs[" + this.ID + "].moveLeft()", this.speed) }; this.rightMouseDown = function () { if (c != "ready") { return } c = "floating"; d = setInterval("ScrollPicleft.childs[" + this.ID + "].moveRight()", this.speed) }; this.moveLeft = function () { if (this.scrollContDiv.scrollLeft + this.space >= this.listDiv01.scrollWidth) { this.scrollContDiv.scrollLeft = this.scrollContDiv.scrollLeft + this.space - this.listDiv01.scrollWidth } else { this.scrollContDiv.scrollLeft += this.space } this.accountPageIndex() }; this.moveRight = function () { if (this.scrollContDiv.scrollLeft - this.space <= 0) { this.scrollContDiv.scrollLeft = this.listDiv01.scrollWidth + this.scrollContDiv.scrollLeft - this.space } else { this.scrollContDiv.scrollLeft -= this.space } this.accountPageIndex() }; this.leftEnd = function () { if (c != "floating") { return } c = "stoping"; clearInterval(d); var h = this.pageWidth - this.scrollContDiv.scrollLeft % this.pageWidth; this.move(h) }; this.rightEnd = function () { if (c != "floating") { return } c = "stoping"; clearInterval(d); var h = -this.scrollContDiv.scrollLeft % this.pageWidth; this.move(h) }; this.move = function (i, j) { var k = i / 5; if (!j) { if (k > this.space) { k = this.space } if (k < -this.space) { k = -this.space } } if (Math.abs(k) < 1 && k != 0) { k = k >= 0 ? 1 : -1 } else { k = Math.round(k) } var h = this.scrollContDiv.scrollLeft + k; if (k > 0) { if (this.scrollContDiv.scrollLeft + k >= this.listDiv01.scrollWidth) { this.scrollContDiv.scrollLeft = this.scrollContDiv.scrollLeft + k - this.listDiv01.scrollWidth } else { this.scrollContDiv.scrollLeft += k } } else { if (this.scrollContDiv.scrollLeft - k <= 0) { this.scrollContDiv.scrollLeft = this.listDiv01.scrollWidth + this.scrollContDiv.scrollLeft - k } else { this.scrollContDiv.scrollLeft += k } } i -= k; if (Math.abs(i) == 0) { c = "ready"; if (this.autoPlay) { this.play() } this.accountPageIndex(); return } else { this.accountPageIndex(); setTimeout("ScrollPicleft.childs[" + this.ID + "].move(" + i + "," + j + ")", this.speed) } }; this.next = function () { if (c != "ready") { return } c = "stoping"; this.move(this.pageWidth, true) }; this.play = function () { if (!this.autoPlay) { return } clearInterval(a); a = setInterval("ScrollPicleft.childs[" + this.ID + "].next()", this.autoPlayTime * 1000) }; this.stop = function () { clearInterval(a) }; this.pageTo = function (h) { if (c != "ready") { return } c = "stoping"; var i = h * this.frameWidth - this.scrollContDiv.scrollLeft; this.move(i, true) }; this.accountPageIndex = function () { this.pageIndex = Math.round(this.scrollContDiv.scrollLeft / this.frameWidth); if (this.pageIndex > Math.round(this.listDiv01.offsetWidth / this.frameWidth + 0.4) - 1) { this.pageIndex = 0 } var h; for (h = 0; h < this.dotObjArr.length; h++) { if (h == this.pageIndex) { this.dotObjArr[h].className = this.dotClassName } else { this.dotObjArr[h].className = this.dotOnClassName } } } };
/*SuperSlide2*/
!function(a){a.fn.slide=function(b){return a.fn.slide.defaults={type:"slide",effect:"fade",autoPlay:!1,delayTime:500,interTime:2500,triggerTime:150,defaultIndex:0,titCell:".hd li",mainCell:".bd",targetCell:null,trigger:"mouseover",scroll:1,vis:1,titOnClassName:"on",autoPage:!1,prevCell:".prev",nextCell:".next",pageStateCell:".pageState",opp:!1,pnLoop:!0,easing:"swing",startFun:null,endFun:null,switchLoad:null,playStateCell:".playState",mouseOverStop:!0,defaultPlay:!0,returnDefault:!1},this.each(function(){var c=a.extend({},a.fn.slide.defaults,b),d=a(this),e=c.effect,f=a(c.prevCell,d),g=a(c.nextCell,d),h=a(c.pageStateCell,d),i=a(c.playStateCell,d),j=a(c.titCell,d),k=j.size(),l=a(c.mainCell,d),m=l.children().size(),n=c.switchLoad,o=a(c.targetCell,d),p=parseInt(c.defaultIndex),q=parseInt(c.delayTime),r=parseInt(c.interTime);parseInt(c.triggerTime);var Q,t=parseInt(c.scroll),u=parseInt(c.vis),v="false"==c.autoPlay||0==c.autoPlay?!1:!0,w="false"==c.opp||0==c.opp?!1:!0,x="false"==c.autoPage||0==c.autoPage?!1:!0,y="false"==c.pnLoop||0==c.pnLoop?!1:!0,z="false"==c.mouseOverStop||0==c.mouseOverStop?!1:!0,A="false"==c.defaultPlay||0==c.defaultPlay?!1:!0,B="false"==c.returnDefault||0==c.returnDefault?!1:!0,C=0,D=0,E=0,F=0,G=c.easing,H=null,I=null,J=null,K=c.titOnClassName,L=j.index(d.find("."+K)),M=p=-1==L?p:L,N=p,O=p,P=m>=u?0!=m%t?m%t:t:0,R="leftMarquee"==e||"topMarquee"==e?!0:!1,S=function(){a.isFunction(c.startFun)&&c.startFun(p,k,d,a(c.titCell,d),l,o,f,g)},T=function(){a.isFunction(c.endFun)&&c.endFun(p,k,d,a(c.titCell,d),l,o,f,g)},U=function(){j.removeClass(K),A&&j.eq(N).addClass(K)};if("menu"==c.type)return A&&j.removeClass(K).eq(p).addClass(K),j.hover(function(){Q=a(this).find(c.targetCell);var b=j.index(a(this));I=setTimeout(function(){switch(p=b,j.removeClass(K).eq(p).addClass(K),S(),e){case"fade":Q.stop(!0,!0).animate({opacity:"show"},q,G,T);break;case"slideDown":Q.stop(!0,!0).animate({height:"show"},q,G,T)}},c.triggerTime)},function(){switch(clearTimeout(I),e){case"fade":Q.animate({opacity:"hide"},q,G);break;case"slideDown":Q.animate({height:"hide"},q,G)}}),B&&d.hover(function(){clearTimeout(J)},function(){J=setTimeout(U,q)}),void 0;if(0==k&&(k=m),R&&(k=2),x){if(m>=u)if("leftLoop"==e||"topLoop"==e)k=0!=m%t?(0^m/t)+1:m/t;else{var V=m-u;k=1+parseInt(0!=V%t?V/t+1:V/t),0>=k&&(k=1)}else k=1;j.html("");var W="";if(1==c.autoPage||"true"==c.autoPage)for(var X=0;k>X;X++)W+="<li>"+(X+1)+"</li>";else for(var X=0;k>X;X++)W+=c.autoPage.replace("$",X+1);j.html(W);var j=j.children()}if(m>=u){l.children().each(function(){a(this).width()>E&&(E=a(this).width(),D=a(this).outerWidth(!0)),a(this).height()>F&&(F=a(this).height(),C=a(this).outerHeight(!0))});var Y=l.children(),Z=function(){for(var a=0;u>a;a++)Y.eq(a).clone().addClass("clone").appendTo(l);for(var a=0;P>a;a++)Y.eq(m-a-1).clone().addClass("clone").prependTo(l)};switch(e){case"fold":l.css({position:"relative",width:D,height:C}).children().css({position:"absolute",width:E,left:0,top:0,display:"none"});break;case"top":l.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; height:'+u*C+'px"></div>').css({top:-(p*t)*C,position:"relative",padding:"0",margin:"0"}).children().css({height:F});break;case"left":l.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; width:'+u*D+'px"></div>').css({width:m*D,left:-(p*t)*D,position:"relative",overflow:"hidden",padding:"0",margin:"0"}).children().css({"float":"left",width:E});break;case"leftLoop":case"leftMarquee":Z(),l.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; width:'+u*D+'px"></div>').css({width:(m+u+P)*D,position:"relative",overflow:"hidden",padding:"0",margin:"0",left:-(P+p*t)*D}).children().css({"float":"left",width:E});break;case"topLoop":case"topMarquee":Z(),l.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; height:'+u*C+'px"></div>').css({height:(m+u+P)*C,position:"relative",padding:"0",margin:"0",top:-(P+p*t)*C}).children().css({height:F})}}var $=function(a){var b=a*t;return a==k?b=m:-1==a&&0!=m%t&&(b=-m%t),b},_=function(b){var c=function(c){for(var d=c;u+c>d;d++)b.eq(d).find("img["+n+"]").each(function(){var b=a(this);if(b.attr("src",b.attr(n)).removeAttr(n),l.find(".clone")[0])for(var c=l.children(),d=0;d<c.size();d++)c.eq(d).find("img["+n+"]").each(function(){a(this).attr(n)==b.attr("src")&&a(this).attr("src",a(this).attr(n)).removeAttr(n)})})};switch(e){case"fade":case"fold":case"top":case"left":case"slideDown":c(p*t);break;case"leftLoop":case"topLoop":c(P+$(O));break;case"leftMarquee":case"topMarquee":var d="leftMarquee"==e?l.css("left").replace("px",""):l.css("top").replace("px",""),f="leftMarquee"==e?D:C,g=P;if(0!=d%f){var h=Math.abs(0^d/f);g=1==p?P+h:P+h-1}c(g)}},ab=function(a){if(!A||M!=p||a||R){if(R?p>=1?p=1:0>=p&&(p=0):(O=p,p>=k?p=0:0>p&&(p=k-1)),S(),null!=n&&_(l.children()),o[0]&&(Q=o.eq(p),null!=n&&_(o),"slideDown"==e?(o.not(Q).stop(!0,!0).slideUp(q),Q.slideDown(q,G,function(){l[0]||T()})):(o.not(Q).stop(!0,!0).hide(),Q.animate({opacity:"show"},q,function(){l[0]||T()}))),m>=u)switch(e){case"fade":l.children().stop(!0,!0).eq(p).animate({opacity:"show"},q,G,function(){T()}).siblings().hide();break;case"fold":l.children().stop(!0,!0).eq(p).animate({opacity:"show"},q,G,function(){T()}).siblings().animate({opacity:"hide"},q,G);break;case"top":l.stop(!0,!1).animate({top:-p*t*C},q,G,function(){T()});break;case"left":l.stop(!0,!1).animate({left:-p*t*D},q,G,function(){T()});break;case"leftLoop":var b=O;l.stop(!0,!0).animate({left:-($(O)+P)*D},q,G,function(){-1>=b?l.css("left",-(P+(k-1)*t)*D):b>=k&&l.css("left",-P*D),T()});break;case"topLoop":var b=O;l.stop(!0,!0).animate({top:-($(O)+P)*C},q,G,function(){-1>=b?l.css("top",-(P+(k-1)*t)*C):b>=k&&l.css("top",-P*C),T()});break;case"leftMarquee":var c=l.css("left").replace("px","");0==p?l.animate({left:++c},0,function(){l.css("left").replace("px","")>=0&&l.css("left",-m*D)}):l.animate({left:--c},0,function(){l.css("left").replace("px","")<=-(m+P)*D&&l.css("left",-P*D)});break;case"topMarquee":var d=l.css("top").replace("px","");0==p?l.animate({top:++d},0,function(){l.css("top").replace("px","")>=0&&l.css("top",-m*C)}):l.animate({top:--d},0,function(){l.css("top").replace("px","")<=-(m+P)*C&&l.css("top",-P*C)})}j.removeClass(K).eq(p).addClass(K),M=p,y||(g.removeClass("nextStop"),f.removeClass("prevStop"),0==p&&f.addClass("prevStop"),p==k-1&&g.addClass("nextStop")),h.html("<span>"+(p+1)+"</span>./"+k)}};A&&ab(!0),B&&d.hover(function(){clearTimeout(J)},function(){J=setTimeout(function(){p=N,A?ab():"slideDown"==e?Q.slideUp(q,U):Q.animate({opacity:"hide"},q,U),M=p},300)});var bb=function(a){H=setInterval(function(){w?p--:p++,ab()},a?a:r)},cb=function(a){H=setInterval(ab,a?a:r)},db=function(){z||(clearInterval(H),bb())},eb=function(){(y||p!=k-1)&&(p++,ab(),R||db())},fb=function(){(y||0!=p)&&(p--,ab(),R||db())},gb=function(){clearInterval(H),R?cb():bb(),i.removeClass("pauseState")},hb=function(){clearInterval(H),i.addClass("pauseState")};if(v?R?(w?p--:p++,cb(),z&&l.hover(hb,gb)):(bb(),z&&d.hover(hb,gb)):(R&&(w?p--:p++),i.addClass("pauseState")),i.click(function(){i.hasClass("pauseState")?gb():hb()}),"mouseover"==c.trigger?j.hover(function(){var a=j.index(this);I=setTimeout(function(){p=a,ab(),db()},c.triggerTime)},function(){clearTimeout(I)}):j.click(function(){p=j.index(this),ab(),db()}),R){if(g.mousedown(eb),f.mousedown(fb),y){var ib,jb=function(){ib=setTimeout(function(){clearInterval(H),cb(0^r/10)},150)},kb=function(){clearTimeout(ib),clearInterval(H),cb()};g.mousedown(jb),g.mouseup(kb),f.mousedown(jb),f.mouseup(kb)}"mouseover"==c.trigger&&(g.hover(eb,function(){}),f.hover(fb,function(){}))}else g.click(eb),f.click(fb)})}}(jQuery),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return 0==b?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return 0==b?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(2==(b/=e/2))return c+d;if(g||(g=e*.3*1.5),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return 1>b?-.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c:.5*h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),(b/=e/2)<1?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:2/2.75>b?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:2.5/2.75>b?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,b,c,d,e){return e/2>b?.5*jQuery.easing.easeInBounce(a,2*b,0,d,e)+c:.5*jQuery.easing.easeOutBounce(a,2*b-e,0,d,e)+.5*d+c}});

$(function () {
    jQuery(".fullSlide").hover(function () {
        jQuery(this).find(".prev,.next").stop(true, true).fadeTo("show", 0.5)
    }, function () {
        jQuery(this).find(".prev,.next").fadeOut()
    });
    jQuery(".fullSlide").slide({
        titCell: ".hd ul",
        mainCell: ".bd ul",
        effect: "fold",
        autoPlay: true,
        autoPage: true,
        trigger: "click",
        startFun: function (i) {
            var curLi = jQuery(".fullslide%20.bd%20li").eq(i);
            if (!!curLi.attr("_src")) {
                curLi.css("background-image", curLi.attr("_src")).css("background-color", "#fff").removeAttr("_src");
            }
        }
    });
});

/*分页JS*/
$(window).load(function(){
	if($('.ban').length > 0){
		if($('.ban').has('img').length > 0){
			var obj = $('.ban').find('img');
			$('.ban').css({'background':'url(' + obj.attr('src') + ') no-repeat center center', 'height':obj.height() + 'px'});
			$('.ban').find('a').css({'height':obj.height() + 'px'});
			obj.attr('src', 'images/x.gif');
		}
	}

	$('.oran_pg_pp').text('上一页');
	$('.oran_pg_fp').text('首页');
	$('.oran_pg_np').text('下一页');
	$('.oran_pg_lp').text('尾页');
});

/*产品缩略图JS效果*/
                $(function () {
                    $(".fc_pro li").mouseover(function () {
                        $(this).children("a").css({ "display": "block" });
                        $(this).find('.jia').hide();
	                });
                    $(".fc_pro li").mouseout(function () {
                        $(this).children("a").hide();
                        $(this).find('.jia').show();
                    });
                });


                /*产品缩略图JS效果*/
                $(function () {
                    $(".tj_pro li").mouseover(function () {
                        $(this).children("a").css({ "display": "block" });
                        $(this).find('.jia').hide();
	                });
                    $(".tj_pro li").mouseout(function () {
                        $(this).children("a").hide();
                        $(this).find('.jia').show();
                    });
                });